# YM2203

YAMAHA製FM音源IC YM2203 に関する情報を集積していきたい

# データシート記載内容邦訳

[datasheet.pdf](./datasheet.pdf)より

## 概要

OPN（FM OPERATOR TYPE-N）は、FM音源方式により、必要な音をすべて作り出すことができる新しいタイプのシンセサイザーです。音情報を記憶できるレジスタを内蔵し、マイクロプロセッサやマイクロコンピュータと容易に接続できます。また、FM方式による音源とは異なる矩形波音源とノイズジェネレータを搭載しています。

## 特徴

- 三和音の同時発音が可能
- 上記3つのサウンドのうち1つを、特定の効果音と合成正弦波サウンドを合成するモードに設定することが可能
- 2つのプログラム可能なタイマーを内蔵
- 2組の8ビット汎用入出力ポートを内蔵
- FM方式のサウンドに加え、3つの矩形波音とホワイトノイズを生成することが可能
- クロック分周器を内蔵し、広い動作周波数帯域を確保
- 入出力はTTLと互換
- N型のSiゲートMOS SLIを採用
- 5Vの単電源を使用
- ゼネラル・インスツルメンツ社製YM2149、AY-3-8910及び8912のソフトウェアに対応

## 端子図

後で図を挿入

## ブロック図

後で図を挿入

## 端子機能の説明

<ol>
  <li>ΦM</li>
  OPN のマスタークロックです。FM音源、矩形波音源は、このクロックを基準に動作します。内蔵の1/6分周器により、最大4.2MHzまでの入力が可能です。
  <li>ΦS・SH</li>
  クロック（ΦS）と同期信号（SH）です。FM音源のデジタル出力をアナログ出力に変換するDAコンバーターを駆動します。
  <li>D<sub>0</sub> から D<sub>7</sub> まで</li>
  OPNとマイクロプロセッサの間でデータとアドレスの交換を行う8ビットの双方向バスです。
  <li>CS・RD・WR・A<sub>0</sub></li>
  これらの信号はD<sub>0</sub>からD<sub>7</sub>までの双方向バスを制御します。
  
  <table>
    <thread>
      <tr>
        <th>CS RD WR A<sub>0</sub></th>
        <th></th>
      </tr>
      <tr>
        <th>0 1 0 0</th>
        <th align="left">OPN のレジスタにアドレスを書き込む</th>
      </tr>
      <tr>
        <th>0 1 0 1</th>
        <th align="left">レジスタの内容をOPNに書き込む</th>
      </tr>
      <tr>
        <th>0 0 1 0</th>
        <th align="left">OPNの状態を読み出す</th>
      </tr>
      <tr>
        <th> 0 0 1 1</th>
        <th align="left">OPNレジスタの内容を読み出す</th>
      </tr>
      <tr>
        <th>1 x x x</th>
        <th align="left">D<sub>0</sub>からD<sub>7</sub>までのバスを高インピーダンスにする</th>
      </tr>
    </thread>
  </table>
  
  <li>IRQ</li>
  これは2つのタイマから送られる割り込み信号です。プログラムによってマスクすることができます。
  <li>IC</li>
  この信号はローレベルでシステムをリセットします。レジスタのデータがすべて0になります。
  <li>OP・O</li>
  FM変調されたオーディオ信号を13ビットのシリアルデータとして出力します。従って、外付けのD/Aコンバーターが必要です。
  <li>アナログチャンネルA, B, C</li>
  アナログ矩形波オーディオ信号です。ソースフォロワのため、抵抗を接続することにより合成が可能です。
  <li>IOA<sub>0</sub> ～ IOA<sub>7</sub> と IOB<sub>0</sub> ～ IOB<sub>7</sub></li>
  8ビット入出力ポートです。それぞれにプルアップ抵抗が内蔵されています。
  <li>AGND</li>
  矩形波音源部に内蔵されたD/Aコンバーターのアナロググランド端子です。
  <li>V<sub>DD</sub></li>
  5Vの電源端子です。
  <li>GND</li>
  グラウンド端子です。
</ol>

## 動作の説明

レジスタに書き込まれたデータに基づいてOPNが制御されます。従って、マイクロプロセッサはレジスタにデータを送る以外の音声制御の動作から解放されます。
FM音源は、4つのサイン波の組み合わせ（変調）によって音を決定します。フィードバックFM、シンプルFM、マルチプルFMなど、あらゆる変調方式が可能です。
矩形波音源については、ソフトウエアレベルでYM2149（SSG音源）、AY-3-8910、8912（PSG音源 ゼネラル・インスツルメンツ社）と互換性があります。そのため、上記LSIとの交換により、OPNの機能を向上させることができます。
OPNの各ブロックの機能は次のとおりです。

- エンベロープジェネレータ（EG）：  
  FM音源のエンベロープと変調波の変調指数を決定します。
- フェーズジェネレータ（PG）：  
  FM音源の各時間ステップにおけるsin波の位相を決定します。
- オペレーター（OP）：  
  EGからの振幅とPGからの位相を基にE sin θの値を計算します。
- アキュムレータ（ACC）：  
  FM音源の各音を合成するために、各チャンネルのオペレータ出力を積算し、D/Aコンバータでマッチングします。
- 矩形波音源／ノイズ生成器：  
  3種類の周波数の矩形波と擬似白色ノイズを発生させます。また、ノイズと矩形波をミックスすることもできます。音量は、固定音量（プログラム値）と10パターンのエンベロープ生成モードが選択できます。このブロックでは、1つの音に対して1つのD/Aカバータが用意されています。
- 入出力ポート制御：  
  外部機器との接続用の汎用入出力ポートです。
- タイマー：  
  2種類のタイマーを搭載しています。

☆レジスタの内容とアドレスマップ
OPNレジスタはアドレスマップに示すように内部アドレスが提供されます。
各レジスタの内容（アドレス）は次のとおりです。

|  | アドレス | 内容 |
| :----: | :---- | :---- |
| (1) | $ 00 ~ $ 05 | 矩形波音源の周波数を生成 |
| (2) | $ 06 | ノイズ源の周波数を生成 |
| (3) | $ 07 | 入出力ポートの入出力を制御し、楽音やノイズを出力することが可能 |
| (4) | $ 08 ~ $ 0A | 音の大きさをコントロールする。</br>音量固定方式（プログラム可能）、音量可変方式を選択可能 |
| (5) | $ 0B ~ $ 0C | 音量可変方式でのエンベロープサイクルを制御 |
| (6) | $ 0D | 音量可変方式におけるエンベロープの形状を指定 |
| (7) | $ 0E ~ $ 0F | 8bitの汎用入出力ポート |
| (8) | $ 21 | テスト情報。常時 `0` |
| (9) | $ 24 ~ $ 26 | タイマA、Bの設定時間を表示 |
| (10) | $ 27 | タイマーA、Bの動作を制御、FM音源の3チャンネル目のモードを設定 |
| (11) | $ 2D ~ $ 2F | 入力クロックの分周比を指定</br>FM音源は1/2 ~ 1/6、矩形波音源は1 ~ 1/4 |
| (12) | $ 30 ~ $ 3E | DetuneとMultipleをコントロール。</br>音色の設定に使用し、基本波と倍音の関係をコントロールします。 |
| (13) | $ 40 ~ $ 4E | 合計レベルを指定する。</br>この情報が、音量の変調指数、変調波の変調指数となります。 |
| (14) | $ 50 ~ $ 5E | キーボード入力に応じて、A・D・S・Rの変化率を調整する。</br>アタックレートは、アタック時のエンベロープの変化率です。 |
| (15) | $ 60 ~ $ 6E | Decay Rateの設定。減衰時のエンベロープの変化率を示します。 |
| (16) | $ 70 ~ $ 7E | Sustain Rateの設定。サスティン時のエンベロープのレート変化量を表示します。 |
| (17) | $ 80 ~ $ 8E |  |
| (18) | $ 90 ~ $ 9E |  |
| (19) | $ A0 ~ $ A6 |  |
| (20) | $ A8 ~ $ AE |  |
| (21) | $ B0 ~ $ B2 |  |

## 書き込みデータ



## 読み書きデータ



## 読み込みデータ



## 電気的特性



## AC特性



## タイミング図



## 外形寸法図

